<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒãƒƒã‚°æƒ…å ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-cyan-500 to-teal-600 min-h-screen p-8">
    <div class="max-w-2xl mx-auto bg-white/10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl border border-white/20">
        <h1 class="text-3xl font-bold text-white mb-6">ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h1>
        
        <div class="space-y-4 text-white">
            <div class="bg-white/10 rounded-xl p-4">
                <h2 class="text-xl font-bold mb-2">ğŸ“± ç’°å¢ƒæƒ…å ±</h2>
                <div class="space-y-1 text-sm">
                    <p>User Agent: <span id="userAgent"></span></p>
                    <p>URL: <span id="currentUrl"></span></p>
                    <p>LocalStorageåˆ©ç”¨å¯èƒ½: <span id="localStorageAvailable"></span></p>
                </div>
            </div>
            
            <div class="bg-white/10 rounded-xl p-4">
                <h2 class="text-xl font-bold mb-2">ğŸ”‘ APIã‚­ãƒ¼çŠ¶æ…‹</h2>
                <div class="space-y-1 text-sm">
                    <p>LocalStorageã«APIã‚­ãƒ¼: <span id="hasApiKey"></span></p>
                    <p>APIã‚­ãƒ¼ï¼ˆæœ€åˆã®5æ–‡å­—ï¼‰: <span id="apiKeyPreview"></span></p>
                    <p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‡ãƒ¼ã‚¿: <span id="playersData"></span></p>
                    <p>é¸æŠæ¸ˆã¿æ›²æ•°: <span id="selectedSongsCount"></span></p>
                </div>
            </div>
            
            <div class="bg-white/10 rounded-xl p-4">
                <h2 class="text-xl font-bold mb-2">ğŸ§ª ãƒ†ã‚¹ãƒˆ</h2>
                <button 
                    onclick="testApiKey()"
                    class="w-full py-3 bg-white text-cyan-600 font-bold rounded-xl hover:bg-white/90 transition-all mb-2"
                >
                    APIã‚­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ
                </button>
                <div id="testResult" class="text-xs mt-2"></div>
            </div>
            
            <div class="bg-white/10 rounded-xl p-4">
                <h2 class="text-xl font-bold mb-2">ğŸ”§ ãƒªã‚»ãƒƒãƒˆ</h2>
                <button 
                    onclick="clearAllData()"
                    class="w-full py-3 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition-all"
                >
                    å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
                </button>
            </div>
            
            <div class="text-center mt-6">
                <a href="setup.html" class="text-cyan-200 underline">APIã‚­ãƒ¼è¨­å®šã«æˆ»ã‚‹</a>
                <span class="mx-2">|</span>
                <a href="mobile-music.html" class="text-cyan-200 underline">ã‚¯ã‚¤ã‚ºã«æˆ»ã‚‹</a>
            </div>
        </div>
    </div>

    <script>
        // ç’°å¢ƒæƒ…å ±ã‚’è¡¨ç¤º
        document.getElementById('userAgent').textContent = navigator.userAgent;
        document.getElementById('currentUrl').textContent = window.location.href;
        document.getElementById('localStorageAvailable').textContent = typeof(Storage) !== "undefined" ? "âœ… ã¯ã„" : "âŒ ã„ã„ãˆ";
        
        // APIã‚­ãƒ¼æƒ…å ±ã‚’è¡¨ç¤º
        const apiKey = localStorage.getItem('youtubeApiKey');
        document.getElementById('hasApiKey').textContent = apiKey ? "âœ… ã‚ã‚Š" : "âŒ ãªã—";
        document.getElementById('apiKeyPreview').textContent = apiKey ? apiKey.substring(0, 5) + "..." : "ãªã—";
        
        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±
        const players = JSON.parse(localStorage.getItem('quizPlayers') || '[]');
        document.getElementById('playersData').textContent = players.length > 0 ? `${players.length}äºº` : "ãªã—";
        
        // é¸æŠæ¸ˆã¿æ›²
        const songs = JSON.parse(localStorage.getItem('selectedSongs') || '[]');
        document.getElementById('selectedSongsCount').textContent = songs.length > 0 ? `${songs.length}æ›²` : "ãªã—";
        
        // APIã‚­ãƒ¼ãƒ†ã‚¹ãƒˆ
        async function testApiKey() {
            const resultDiv = document.getElementById('testResult');
            const apiKey = localStorage.getItem('youtubeApiKey');
            
            if (!apiKey) {
                resultDiv.innerHTML = '<p class="text-red-300">âŒ APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>';
                return;
            }
            
            resultDiv.innerHTML = '<p class="text-yellow-300">ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­...</p>';
            
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&q=test&type=video&maxResults=1&key=${apiKey}`
                );
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = '<p class="text-green-300">âœ… APIã‚­ãƒ¼ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™</p>';
                } else {
                    const error = await response.json();
                    resultDiv.innerHTML = `<p class="text-red-300">âŒ ã‚¨ãƒ©ãƒ¼: ${error.error.message}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="text-red-300">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</p>`;
            }
        }
        
        // å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
        function clearAllData() {
            if (confirm('å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆAPIã‚­ãƒ¼ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€æ›²ã€ã‚¹ã‚³ã‚¢ï¼‰ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.clear();
                alert('å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚setup.htmlã§APIã‚­ãƒ¼ã‚’å†è¨­å®šã—ã¦ãã ã•ã„ã€‚');
                location.reload();
            }
        }
    </script>
</body>
</html>
